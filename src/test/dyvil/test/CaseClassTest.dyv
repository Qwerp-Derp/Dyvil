package dyvil.test

import java.io._

public class CaseClassTest
{
	public case class Person(long id, String name, int age, double height)

	public static void main([String] args)
	{
		let id = 1234567890L
		let name = "Peter Peterson"
		let age = 20
		let height = 1.92
		let person = Person(id, name, age, height)

		Main.test("Case Class Equality", new Person(id, name, age, height), person)
		Main.test("Case Class hashCode", new Person(id, name, age, height).hashCode, person.hashCode)

		Main.test("Case Class toString", "Person(\(id), \(name), \(age), \(height))", person.toString)

		// ---- Serialize ----

		let bos = new ByteArrayOutputStream
		let oos = new ObjectOutputStream(bos)

		oos.writeObject(person)
		oos.close()

		let bytes = bos.toByteArray

		// ---- Deserialize ----

		let ois = new ObjectInputStream(new ByteArrayInputStream(bytes))
		let deserialized = ois.readObject

		Main.test("Case Class Serialization", person, deserialized)
	}
}
